import{GetItemCommand as m,UpdateItemCommand as c}from"@aws-sdk/client-dynamodb";import{DynamoDBClient as d}from"@aws-sdk/client-dynamodb";var n=new d({region:"eu-north-1"});var S=async t=>{try{let e=t.pathParameters&&t.pathParameters.id;if(!e)return r(400,{error:"Missing id"});let i=JSON.parse(t.body||"{}"),{text:s}=i;if(!s)return r(400,{error:"text required"});let o=await n.send(new m({TableName:process.env.TABLE_NAME||"ShuiMessages",Key:{messageId:{S:e}}}));if(!o.Item)return r(404,{error:"Message not found"});let a=new Date().toISOString();return await n.send(new c({TableName:process.env.TABLE_NAME||"ShuiMessages",Key:{messageId:{S:e}},UpdateExpression:"SET #t = :text, updatedAt = :u",ExpressionAttributeNames:{"#t":"text"},ExpressionAttributeValues:{":text":{S:s},":u":{S:a}}})),r(200,{id:e,text:s,username:o.Item.username.S,createdAt:o.Item.createdAt.S,updatedAt:a})}catch(e){return console.error("updateMessage error",e),r(500,{error:"Internal error"})}},r=(t,e)=>({statusCode:t,headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"http://localhost:5173","Access-Control-Allow-Credentials":"true"},body:JSON.stringify(e)});export{S as handler};
//# sourceMappingURL=index.js.map
