import{GetItemCommand as d,UpdateItemCommand as p}from"@aws-sdk/client-dynamodb";import{DynamoDBClient as i}from"@aws-sdk/client-dynamodb";var o=new i({region:"eu-north-1"});var t=(r,e)=>({statusCode:r,headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":!0},body:JSON.stringify(e)});var S=async r=>{try{let e=r.pathParameters&&r.pathParameters.id;if(!e)return t(400,{error:"Missing id"});let a=JSON.parse(r.body||"{}"),{text:s}=a;if(!s)return t(400,{error:"text required"});if(!(await o.send(new d({TableName:process.env.TABLE_NAME||"ShuiMessages",Key:{messageId:{S:e}}}))).Item)return t(404,{error:"Message not found"});let n=new Date().toISOString();return await o.send(new p({TableName:process.env.TABLE_NAME||"ShuiMessages",Key:{messageId:{S:e}},UpdateExpression:"SET #t = :text, updatedAt = :u",ExpressionAttributeNames:{"#t":"text"},ExpressionAttributeValues:{":text":{S:s},":u":{S:n}}})),t(200,{id:e,text:s,updatedAt:n})}catch(e){return console.error("updateMessage error",e),t(500,{error:"Internal error"})}};export{S as handler};
//# sourceMappingURL=index.js.map
