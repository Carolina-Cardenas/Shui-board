import{GetItemCommand as d,UpdateItemCommand as p}from"@aws-sdk/client-dynamodb";import{DynamoDBClient as i}from"@aws-sdk/client-dynamodb";var o=new i({region:"eu-north-1"});var A=async t=>{try{let e=t.pathParameters&&t.pathParameters.id;if(!e)return r(400,{error:"Missing id"});let a=JSON.parse(t.body||"{}"),{text:s}=a;if(!s)return r(400,{error:"text required"});if(!(await o.send(new d({TableName:process.env.TABLE_NAME||"ShuiMessages",Key:{messageId:{S:e}}}))).Item)return r(404,{error:"Message not found"});let n=new Date().toISOString();return await o.send(new p({TableName:process.env.TABLE_NAME||"ShuiMessages",Key:{messageId:{S:e}},UpdateExpression:"SET #t = :text, updatedAt = :u",ExpressionAttributeNames:{"#t":"text"},ExpressionAttributeValues:{":text":{S:s},":u":{S:n}}})),r(200,{id:e,text:s,updatedAt:n})}catch(e){return console.error("updateMessage error",e),r(500,{error:"Internal error"})}},r=(t,e)=>({statusCode:t,headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"http://localhost:5173","Access-Control-Allow-Credentials":"true"},body:JSON.stringify(e)});export{A as handler};
//# sourceMappingURL=index.js.map
